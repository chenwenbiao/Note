# JVM启动参数大全及默认值

## Java启动参数共分为三类；

1. 其一是标准参数（-），所有的JVM实现都必须实现这些参数的功能，而且向后兼容；
2. 其二是非标准参数（-X），默认jvm实现这些参数的功能，但是并不保证所有jvm实现都满足，且不保证向后兼容；
3. 其三是非Stable参数（-XX），此类参数各个jvm实现会有所不同，将来可能会随时取消，需要慎重使用；

## 重点参数(先介绍重点再介绍具体分类)

```
永久代:-XX:PermSize20M -XX:MaxPermSize20M

堆大小: -Xms20M -Xmx20M

新生代: -Xmn10M

Eden与survior比率: -XX:SurvivorRation=8

让大对象直接进入老年代: -XX:PretrnureSizeThreshold=1B

年龄阈值:-XX:MaxTenuringThreshold=15
```

## 一、JVM标准参数(-)

JVM的标准参数都是以"-"开头，通过输入`"java -help"或者"java -?"`，可以查看JVM标准参数列表。如

以下是JVM标准参数的详细介绍(红色标记的参数请着重注意):

* -client: 设置jvm使用client模式，特点是启动速度比较快，但运行时性能和内存管理效率不高，通常用于客户端应用程序或者PC应用开发和调试。
* -server: 设置jvm使server模式，特点是启动速度比较慢，但运行时性能和内存管理效率很高，适用于生产环境。在具有64位能力的jdk环境下将默认启用该模式，而忽略-client参数。
* -classpath classpath(简写: -cp classpath): 告知jvm搜索目录名、jar名、zip名，之间用分号;分隔；使用-classpath后jvm将不再使用CLASSPATH中的类搜索路径，如果-classpath和CLASSPATH都没有设置，则jvm使用当前路径(.)作为类搜索路径。
* -Dproperty=value: 设置系统属性名/值对，运行在此jvm之上的应用程序可用System.getProperty("property")得到value的值。如果value中有空格，则需要用双引号将该值括起来，如-Dname="space string"。该参数通常用于设置系统级全局变量值，如配置文件路径，以便该属性在程序中任何地方都可访问。
* -jar: 指定以jar包的形式执行一个应用程序。要这样执行一个应用程序，必须让jar包的manifest文件中声明初始加载的Main-class，当然那Main-class必须有public static void main(String[] args)方法。
* -verbose:class(-verbose): 输出jvm载入类的相关信息，当jvm报告说找不到类或者类冲突时可此进行诊断。
* -verbose:gc : 输出每次GC的相关情况。
* -verbose:jni: 输出native方法调用的相关情况，一般用于诊断jni调用错误信息。
* -version : 输出java的版本信息，比如jdk版本、vendor、model。
* -?(-help) : 输出java标准参数列表及其描述。

## 二、JVM非标准参数(-X)

通过"java -X"可以输出非标准参数列表非标准参数又称为扩展参数，其列表如下：

* -Xbootclasspath:bootclasspath: 让jvm从指定路径（可以是分号分隔的目录、jar、或者zip）中加载bootclass，用来替换jdk的rt.jar；若非必要，一般不会用到；
* -Xbootclasspath/a:path: 将指定路径的所有文件追加到默认bootstrap路径中；
* -Xbootclasspath/p:path: 让jvm优先于bootstrap默认路径加载指定路径的所有文件；
* -Xloggc:file: 与-verbose:gc功能类似，只是将每次GC事件的相关情况记录到一个文件中，文件的位置最好在本地，以避免网络的潜在问题。若与verbose命令同时出现在命令行中，则以-Xloggc为准。
* -Xms<size>: 指定jvm堆的初始大小，默认为物理内存的1/64，最小为1M；可以指定单位，比如k、m，若不指定，则默认为字节。
* -Xmx<size>: 指定jvm堆的最大值，默认为物理内存的1/4或者1G，最小为2M；单位与-Xms一致。
* -Xss<size>: 设置单个线程栈的大小，一般默认为512k。 
* -Xprof: 输出 cpu 配置文件数据

>上面这些参数中，比如-Xms、-Xmx……都是我们性能优化中很重要的参数；-Xprof、-Xloggc:file等都是在没有专业跟踪工具情况下排错的好手；

## 三、JVM非Stable参数（-XX）

Java 6版本， HotSpot JVM 提供给了两个新的参数，在JVM启动后，在命令行中可以输出所有XX参数和值:`java -XX:+PrintFlagsInitial  -XX:+PrintFlagsInitial>>1.txt`

>由于非Stable参数非常的多，因此这里只介绍我们比较常用的。这些参数可以被松散的聚合成三类：

1. 行为参数（Behavioral Options）：用于改变jvm的一些基础行为；
2. 性能调优（Performance Tuning）：用于jvm的性能调优；
3. 调试参数（Debugging Options）：一般用于打开跟踪、打印、输出等jvm参数，用于显示jvm更加详细的信息；

### 行为参数(功能开关)

```
-XX:-DisableExplicitGC	禁止调用System.gc()；但jvm的gc仍然有效

-XX:+MaxFDLimit	最大化文件描述符的数量限制

-XX:+ScavengeBeforeFullGC	新生代GC优先于Full GC执行

-XX:+UseGCOverheadLimit	在抛出OOM之前限制jvm耗费在GC上的时间比例

-XX:-UseConcMarkSweepGC	对老生代采用并发标记交换算法进行GC

-XX:-UseParallelGC	启用并行GC

-XX:-UseParallelOldGC	对Full GC启用并行，当-XX:-UseParallelGC启用时该项自动启用

-XX:-UseSerialGC	启用串行GC

-XX:+UseThreadPriorities	启用本地线程优先级
```


### 性能调优(重点)

```
-XX:LargePageSizeInBytes=4m	设置用于Java堆的大页面尺寸

-XX:MaxHeapFreeRatio=70	GC后java堆中空闲量占的最大比例

-XX:MaxNewSize=size	新生成对象能占用内存的最大值

-XX:MaxPermSize=64m	老生代对象能占用内存的最大值

-XX:MinHeapFreeRatio=40	GC后java堆中空闲量占的最小比例

-XX:NewRatio=2	新生代内存容量与老生代内存容量的比例

-XX:NewSize=2.125m	新生代对象生成时占用内存的默认值

-XX:ReservedCodeCacheSize=32m	保留代码占用的内存容量

-XX:ThreadStackSize=512	设置线程栈大小，若为0则使用系统默认值

-XX:+UseLargePages	使用大页面内存
```

### 调试参数

```
-XX:-CITime	打印消耗在JIT编译的时间

-XX:ErrorFile=./hs_err_pid<pid>.log	保存错误日志或者数据到文件中

-XX:-ExtendedDTraceProbes	开启solaris特有的dtrace探针

-XX:HeapDumpPath=./java_pid<pid>.hprof	指定导出堆信息时的路径或文件名

-XX:-HeapDumpOnOutOfMemoryError	当首次遭遇OOM时导出此时堆中相关信息

-XX:OnError="<cmd args>;<cmd args>"	出现致命ERROR之后运行自定义命令

-XX:OnOutOfMemoryError="<cmd args>;<cmd args>"	当首次遭遇OOM时执行自定义命令

-XX:-PrintClassHistogram	遇到Ctrl-Break后打印类实例的柱状信息，与jmap -histo功能相同

-XX:-PrintConcurrentLocks	遇到Ctrl-Break后打印并发锁的相关信息，与jstack -l功能相同

-XX:-PrintCommandLineFlags	打印在命令行中出现过的标记

-XX:-PrintCompilation	当一个方法被编译时打印相关信息

-XX:-PrintGC	每次GC时打印相关信息

-XX:-PrintGC Details	每次GC时打印详细信息

-XX:-PrintGCTimeStamps	打印每次GC的时间戳

-XX:-TraceClassLoading	跟踪类的加载信息

-XX:-TraceClassLoadingPreorder	跟踪被引用到的所有类的加载信息

-XX:-TraceClassResolution	跟踪常量池

-XX:-TraceClassUnloading	跟踪类的卸载信息

-XX:-TraceLoaderConstraints	跟踪类加载器约束的相关信息
```
