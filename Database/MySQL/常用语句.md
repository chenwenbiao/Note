#### 一, Commonly used statements

##### 1, database backup and restore

```shell
mysqldump -u root -p1 test > d:\test.sql
mysql> source d:\test.sql
```

```shell
mysql -u root –p
mysql -u root -p < schema.sql
show create database db;
CREATE DATABASE if not exists <dbname> CHARACTER SET utf8;(要设置编码，防止创建列出错)
ALTER DATABASE DBNAME CHARACTER SET utf8 COLLATE utf8_general_ci;
drop database if exists <db_name>;
show create table t;
desc tableName;
rename table t to t1;
drop table t3;
alter table small change column STBMAC id text;
ALTER TABLE table_name ADD column_name datatype;
alter table t add age int;
alter table t drop id;
alter table t modify age tinyint;
alter table t change column name username varchar(30);
删除主键：alter table stu drop primary key;
```

* 删除主键之前一定要删除当前主键的外键约束
* not null 非空约束，此字段值不能为空
* unique 唯一约束，此字段值必须唯一，但可以为空

#### 二, Character set

查看Mysql的支持的字符集:
show character set

查看数据库中所有的校对规则
show collation;

	Collation校对规则：负责决定某一字符集下的字符进行比较和排序的结果。

创建一个数据库db2,字符集用gbk，校对规则用gbk_bin
create database db1 character set gbk collate gbk_bin;

查看中文校对规则
show collation like '%gb%';

设置客户端的字符集为gbk
set character_set_client = gbk;

设置结果集的字符集为gbk
set character_set_results = gbk;

show variables like 'validate_password%';

set global validate_password_length = 6;

Enter the following if the database user already exists.:

GRANT SELECT ON database.* TO user@'localhost';

To enable more options, you would separate them with a comma. So to enable SELECT, INSERT, and DELETE your syntax would look like this:

GRANT SELECT, INSERT, DELETE ON database TO username@'localhost' IDENTIFIED BY 'password';

#### 三，多表查询

##### 1，交叉查询

```shell
select * from stu cross join score;
select * from stu,score;
```

##### 2, 内连接

* 显式内连接

```shell
select * from stu s inner join score c on s.id = c.id;
```

* 隐式内连接

```shell
select * from stu s ,score c where s.id = c.id;
```

##### 3, 外连接

* 左外连接（left out join）

* 右外连接（right outer join）

> 与内连接不同的是，外连接不仅返回连接表中符合连接条件及查询条件的数据行，也返回左
表（左外连接时）或右表（右外连接时）中仅符合查询条件但不符合连接条件的数据行

```shell
select * from stu s left outer join score c on s.id = c.sid;
```

##### 4, 子查询

```shell
select * from stu where id not in(select sid from score);
```

##### 5, 联合查询

```shell
select * from stu where id = 1 union select * from stu where address = '桃花岛';
```

##### 6, 报表查询

```shell
select count(*) 人数, sex from stu group by sex having  count(*) > 2;
```

#### 四, 合计函数（聚合函数）

返回某一列，行的总数:
```shell
select count(id) from stu;
```

sum(english)：统计英语总分，返回满足where条件的行的和
```shell
select sum(chinese) 语文总分 form score;
```

avg(english):返回满足where条件的一列的平均值
```shell
select avg(chinese) from score;
```

Max/min函数返回满足where条件的一列的最大/最小值
```shell
select max(chinese) from score; select min(chinese) from score;
```

### 关于编码

MySQL 的「utf8」实际上不是真正的 UTF-8。

「utf8」只支持每个字符最多三个字节，而真正的 UTF-8 是每个字符最多四个字节。MySQL 一直没有修复这个 bug，他们在 2010 年发布了一个叫作「utf8mb4」的字符集，绕过了这个问题。当然，他们并没有对新的字符集广而告之（可能是因为这个 bug 让他们觉得很尴尬），以致于现在网络上仍然在建议开发者使用「utf8」，但这些建议都是错误的。

简单概括如下：

1. MySQL 的「utf8mb4」是真正的「UTF-8」。
2. MySQL 的「utf8」是一种「专属的编码」，它能够编码的 Unicode 字符并不多。

我要在这里澄清一下：所有在使用「utf8」的 MySQL 和 MariaDB 用户都应该改用「utf8mb4」，永远都不要再使用「utf8」。

#### 什么是编码？什么是 UTF-8？

我们都知道，计算机使用 0 和 1 来存储文本。比如字符「C」被存成「01000011」，那么计算机在显示这个字符时需要经过两个步骤：

1. 计算机读取「01000011」，得到数字67(也就是「01000011」的十进制形式)，
2. 计算机在Unicode字符集中查找 67，找到了「C」。

同样的：

1. 我的电脑将「C」映射成Unicode字符集中的 67。
2. 我的电脑将67编码成「01000011」，并发送给 Web 服务器。

几乎所有的网络应用都使用了 Unicode 字符集，因为没有理由使用其他字符集。

Unicode 字符集包含了上百万个字符。最简单的编码是 UTF-32，每个字符使用 32 位。这样做最简单，但问题是，这样太浪费空间了。

UTF-8 可以节省空间，在 UTF-8 中，字符「C」只需要 8 位，一些不常用的字符，比如「」需要 32 位。其他的字符可能使用 16 位或 24 位。一篇类似本文这样的文章，如果使用 UTF-8 编码，占用的空间只有 UTF-32 的四分之一左右。

MySQL 的「utf8」字符集与其他程序不兼容，它所谓的字符集，可能真的是一坨……